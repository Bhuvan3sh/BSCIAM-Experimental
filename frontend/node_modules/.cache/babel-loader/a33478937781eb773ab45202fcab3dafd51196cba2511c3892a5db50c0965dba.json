{"ast":null,"code":"const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:3001/api';\nclass FileApiError extends Error {\n  constructor(message, status, response) {\n    super(message);\n    this.status = status;\n    this.response = response;\n    this.name = 'FileApiError';\n  }\n}\n\n/**\r\n * File API service for communicating with the backend server\r\n */\nexport const fileApi = {\n  /**\r\n   * Upload an encrypted file to the server\r\n   */\n  async uploadFile(data) {\n    try {\n      const response = await fetch(`${API_BASE_URL}/files/upload`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new FileApiError(errorData.error || 'Failed to upload file', response.status, errorData);\n      }\n      return await response.json();\n    } catch (error) {\n      if (error instanceof FileApiError) {\n        throw error;\n      }\n      throw new FileApiError(`Network error: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  },\n  /**\r\n   * Get all files for a wallet address (metadata only)\r\n   */\n  async getFiles(walletAddress) {\n    try {\n      const response = await fetch(`${API_BASE_URL}/files?walletAddress=${encodeURIComponent(walletAddress)}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new FileApiError(errorData.error || 'Failed to fetch files', response.status, errorData);\n      }\n      return await response.json();\n    } catch (error) {\n      if (error instanceof FileApiError) {\n        throw error;\n      }\n      throw new FileApiError(`Network error: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  },\n  /**\r\n   * Get encrypted file content by file ID\r\n   */\n  async getEncryptedFile(fileId, walletAddress) {\n    try {\n      const response = await fetch(`${API_BASE_URL}/files/${fileId}/encrypted?walletAddress=${encodeURIComponent(walletAddress)}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new FileApiError(errorData.error || 'Failed to fetch encrypted file', response.status, errorData);\n      }\n      return await response.json();\n    } catch (error) {\n      if (error instanceof FileApiError) {\n        throw error;\n      }\n      throw new FileApiError(`Network error: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  },\n  /**\r\n   * Update/modify an existing file\r\n   */\n  async updateFile(fileId, encryptedData, metadata, walletAddress) {\n    try {\n      const response = await fetch(`${API_BASE_URL}/files/${fileId}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          encryptedData,\n          metadata,\n          walletAddress\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new FileApiError(errorData.error || 'Failed to update file', response.status, errorData);\n      }\n      return await response.json();\n    } catch (error) {\n      if (error instanceof FileApiError) {\n        throw error;\n      }\n      throw new FileApiError(`Network error: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  },\n  /**\r\n   * Delete a file\r\n   */\n  async deleteFile(fileId, walletAddress) {\n    try {\n      const response = await fetch(`${API_BASE_URL}/files/${fileId}?walletAddress=${encodeURIComponent(walletAddress)}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new FileApiError(errorData.error || 'Failed to delete file', response.status, errorData);\n      }\n      return await response.json();\n    } catch (error) {\n      if (error instanceof FileApiError) {\n        throw error;\n      }\n      throw new FileApiError(`Network error: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n};","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","FileApiError","Error","constructor","message","status","response","name","fileApi","uploadFile","data","fetch","method","headers","body","JSON","stringify","ok","errorData","json","catch","error","getFiles","walletAddress","encodeURIComponent","getEncryptedFile","fileId","updateFile","encryptedData","metadata","deleteFile"],"sources":["F:/Final Year Project/Project Implementation/BSCIAM-Experimental/frontend/src/services/fileApi.ts"],"sourcesContent":["const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:3001/api';\r\n\r\nexport interface UploadFileRequest {\r\n  fileId: string;\r\n  encryptedData: string;\r\n  metadata: {\r\n    name: string;\r\n    type: string;\r\n    size: number;\r\n    lastModified: number;\r\n    originalName?: string;\r\n    mimeType?: string;\r\n  };\r\n  walletAddress: string;\r\n}\r\n\r\nexport interface StoredFile {\r\n  id: string;\r\n  name: string;\r\n  type: string;\r\n  size: number;\r\n  uploadedAt: string;\r\n  encryptedData: string;\r\n  metadata: {\r\n    name: string;\r\n    originalName: string;\r\n    type: string;\r\n    mimeType: string;\r\n    size: number;\r\n    lastModified: number;\r\n  };\r\n}\r\n\r\nexport interface EncryptedFileResponse {\r\n  encryptedData: string;\r\n}\r\n\r\nclass FileApiError extends Error {\r\n  constructor(\r\n    message: string,\r\n    public status?: number,\r\n    public response?: any\r\n  ) {\r\n    super(message);\r\n    this.name = 'FileApiError';\r\n  }\r\n}\r\n\r\n/**\r\n * File API service for communicating with the backend server\r\n */\r\nexport const fileApi = {\r\n  /**\r\n   * Upload an encrypted file to the server\r\n   */\r\n  async uploadFile(data: UploadFileRequest): Promise<{ fileId: string }> {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/files/upload`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(data),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        throw new FileApiError(\r\n          errorData.error || 'Failed to upload file',\r\n          response.status,\r\n          errorData\r\n        );\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      if (error instanceof FileApiError) {\r\n        throw error;\r\n      }\r\n      throw new FileApiError(\r\n        `Network error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      );\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Get all files for a wallet address (metadata only)\r\n   */\r\n  async getFiles(walletAddress: string): Promise<StoredFile[]> {\r\n    try {\r\n      const response = await fetch(\r\n        `${API_BASE_URL}/files?walletAddress=${encodeURIComponent(walletAddress)}`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        throw new FileApiError(\r\n          errorData.error || 'Failed to fetch files',\r\n          response.status,\r\n          errorData\r\n        );\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      if (error instanceof FileApiError) {\r\n        throw error;\r\n      }\r\n      throw new FileApiError(\r\n        `Network error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      );\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Get encrypted file content by file ID\r\n   */\r\n  async getEncryptedFile(\r\n    fileId: string,\r\n    walletAddress: string\r\n  ): Promise<EncryptedFileResponse> {\r\n    try {\r\n      const response = await fetch(\r\n        `${API_BASE_URL}/files/${fileId}/encrypted?walletAddress=${encodeURIComponent(walletAddress)}`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        throw new FileApiError(\r\n          errorData.error || 'Failed to fetch encrypted file',\r\n          response.status,\r\n          errorData\r\n        );\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      if (error instanceof FileApiError) {\r\n        throw error;\r\n      }\r\n      throw new FileApiError(\r\n        `Network error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      );\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Update/modify an existing file\r\n   */\r\n  async updateFile(\r\n    fileId: string,\r\n    encryptedData: string,\r\n    metadata: any,\r\n    walletAddress: string\r\n  ): Promise<void> {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/files/${fileId}`, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          encryptedData,\r\n          metadata,\r\n          walletAddress,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        throw new FileApiError(\r\n          errorData.error || 'Failed to update file',\r\n          response.status,\r\n          errorData\r\n        );\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      if (error instanceof FileApiError) {\r\n        throw error;\r\n      }\r\n      throw new FileApiError(\r\n        `Network error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      );\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Delete a file\r\n   */\r\n  async deleteFile(fileId: string, walletAddress: string): Promise<void> {\r\n    try {\r\n      const response = await fetch(\r\n        `${API_BASE_URL}/files/${fileId}?walletAddress=${encodeURIComponent(walletAddress)}`,\r\n        {\r\n          method: 'DELETE',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        throw new FileApiError(\r\n          errorData.error || 'Failed to delete file',\r\n          response.status,\r\n          errorData\r\n        );\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      if (error instanceof FileApiError) {\r\n        throw error;\r\n      }\r\n      throw new FileApiError(\r\n        `Network error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      );\r\n    }\r\n  },\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}